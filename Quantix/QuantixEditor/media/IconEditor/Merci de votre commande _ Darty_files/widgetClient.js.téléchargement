!function(r,c){var d={},l=!1,p={},t=!1,i=!1,h="displayed-by-rules",u="masked-at-init";d.initEventListeners=function(){if(!t){var e=r.addEventListener?"addEventListener":"attachEvent";(0,r[e])("attachEvent"==e?"onmessage":"message",d.processEvent,!1),t=!0}},d.launchIfConversationStarted=function(e){d.initObj=JSON.parse(JSON.stringify(e)),d.container=c.createElement("iframe"),d.container.src=d.initObj.domain.replace("/widget","/client/hub.html"),d.container.setAttribute("id","easichat:hub"),d.container.setAttribute("style","display:none"),d.initObj.scope&&(d.container.src+="?scope="+d.initObj.scope),d.initEventListeners(),c.body.appendChild(d.container)},d.init=function(e){i||(i=!0,c.URL.indexOf("noWidget")<0&&(d.container=c.createElement("iframe"),d.container.setAttribute("id","widgetClientToctoc"),d.container.scrolling="no",d.container.setAttribute("class","hidden"),d.switchToChannel(e),d.initCss(),!0===(d.initObj.hidden||void 0)&&d.container.classList.add(u),d.initEventListeners(),c.body.appendChild(d.container)))},d.processEvent=function(t){var e,i=["circleMode","closed","open","loginScreen","hidden","nps"];switch((e=t.data)&&e.toString().startsWith("easichat:getChannelStatus")?"easichat:getChannelStatus":e){case"easichat:tokenExists":var n=c.getElementById("easichat:hub");n.parentNode.removeChild(n),d.init(d.initObj);break;case"circleModeEnabled":d.circleModeEnabled=!0,i.forEach(function(e){d.container.classList.remove(e)}),d.container.classList.add("circleMode");break;case"resizeMedium":i.forEach(function(e){d.container.classList.remove(e)}),d.container.classList.add("open"),r.postMessage("easichat:open","*");break;case"resizeMini":d.circleModeEnabled=!1,i.forEach(function(e){d.container.classList.remove(e)}),d.container.classList.add("closed"),r.postMessage("easichat:resizeMini","*");break;case"resizeForLogin":i.forEach(function(e){d.container.classList.remove(e)}),d.container.classList.add("loginScreen");break;case"resizeForNps":i.forEach(function(e){d.container.classList.remove(e)}),d.container.classList.add("nps");break;case"resizeClose":i.forEach(function(e){d.container.classList.remove(e)}),d.container.classList.add("hidden");break;case"getUrl":var o={current:c.URL,referrer:c.referrer};c.querySelector("body iframe#widgetClientToctoc").contentWindow.postMessage("URL:"+JSON.stringify(o),"*");break;case"easichat:getChannelStatus":r.postMessage(t.data.replace("easichat:getChannelStatus","easichat:status"),"*");break;case"easichat:intent:collapse":r.postMessage("easichat:collapse","*");break;default:try{var a=JSON.parse(t.data);void 0!==a.type&&"conversationStarted"===a.type&&(d.container.classList.remove(u),d.container.classList.add(h),function(e){var i=e.id||void 0,t=e.cb||void 0;if(i){var n=d.container.getAttribute("data-uuid");d.container.setAttribute("data-uuid",i),n!=i&&l&&(Upscope("updateConnection",{uniqueId:i}),void 0!==Upscope._config.requireAuthorizationForSession&&void 0!==p.requireAuthorizationForSession&&(Upscope._config.requireAuthorizationForSession=p.requireAuthorizationForSession))}if(t&&i&&!1===l){d.container.setAttribute("data-upscope-viewer-display","none"),function(e,t,i,n){var o=function(){o.c(arguments)};o.q=[],o.c=function(e){o.q.push(e)};"function"!=typeof t&&(e.Upscope=o,function(){var e=i.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://code.upscope.io/"+n+".js";var t=i.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}())}(r,r.Upscope,c,t);try{Upscope("init",{uniqueId:i,onConnection:function(){p.requireAuthorizationForSession=Upscope._config.requireAuthorizationForSession,r.localStorage&&r.localStorage.getItem(i+"::hasAcceptedSession")&&(Upscope._config.requireAuthorizationForSession=!1)},requireAuthorizationForSession:!(r.localStorage&&r.localStorage.getItem(i+"::hasAcceptedSession"))}),Upscope("on","sessionStart",function(e,t){r.localStorage.setItem(i+"::hasAcceptedSession",!0),Upscope._config.requireAuthorizationForSession=!1}),l=!0}catch(e){console.error(e)}}}(a))}catch(e){var s=JSON.stringify(t.data);-1<s.indexOf("init")?d.init(JSON.parse(s.replace("init",""))):null!=d.initObj.channelId&&0==d.initObj.channelId&&null!=t.data.config&&c.querySelector("body iframe#widgetClientToctoc").contentWindow.postMessage(t.data,"*")}}},d.collapse=function(){return null!=d.circleModeEnabled&&1==d.circleModeEnabled?d.processEvent({data:"circleModeEnabled"}):d.processEvent({data:"resizeMini"}),d.container&&(d.container.contentWindow.postMessage("close","*"),r.postMessage("easichat:collapse","*")),d},d.open=function(){return d.processEvent({data:"resizeMedium"}),d.container&&(d.container.contentWindow.postMessage("open","*"),d.container.classList.remove(u),d.container.classList.add(h)),d},d.close=function(){return d.processEvent({data:"resizeClose"}),d.container&&(d.container.contentWindow.postMessage("hide","*"),r.postMessage("easichat:close","*")),d},d.hide=function(){return d.container&&(d.container.classList.add(u),d.container.classList.remove(h),r.postMessage("easichat:hide","*")),d},d.goToLogin=function(){d.processEvent({data:"resizeForLogin"}),c.querySelector("body iframe#widgetClientToctoc").contentWindow.postMessage("goToLogin","*")},d.goToChat=function(){d.processEvent({data:"resizeMedium"}),c.querySelector("body iframe#widgetClientToctoc").contentWindow.postMessage("goToChat","*")},d.goToNps=function(){d.processEvent({data:"resizeForNps"}),c.querySelector("body iframe#widgetClientToctoc").contentWindow.postMessage("goToNps","*")},d.initCss=function(){var e="                #widgetClientToctoc.masked-at-init {                  display: none !important;                }                        #widgetClientToctoc.displayed-by-rules {                  display: block;                }                        #widgetClientToctoc.loginScreen {                    width: 400px;                    height: 490px;                    border-top-left-radius: 5px;                    border-top-right-radius: 5px;                    z-index: 901000;                    border: none;                    position: fixed;                    bottom: "+(d.initObj.bottom||"10px")+";                    right: "+(d.initObj.right||"0px")+";                    box-shadow: 0 1px 15px rgba(0, 0, 0, 0.23);                }                        #widgetClientToctoc.nps {                    width: 350px;                    height: 400px;                    border-radius: 10px;                    z-index: 901000;                    border: none;                    position: fixed;                    bottom: "+(d.initObj.bottom||"10px")+";                    right: "+(d.initObj.right||"0px")+";                    box-shadow: 0 1px 15px rgba(0, 0, 0, 0.23);                }                        #widgetClientToctoc.circleMode {                    width: 80px;                    height: 80px;                    z-index: 800000;                    border: none;                    position: fixed;                    bottom: "+(d.initObj.bottom||"10px")+";                    right: "+(d.initObj.right||"0px")+";                    box-shadow: 0 1px 15px rgba(0, 0, 0, 0.23);                    border-radius: 50% !important;                }                                #widgetClientToctoc.open {                    width: 330px;                    height: 400px;                    border-top-left-radius: 5px;                    border-top-right-radius: 5px;                    z-index: 2147483647;                    border: none;                    position: fixed;                    bottom: "+(d.initObj.bottom||"10px")+";                    right: "+(d.initObj.right||"0px")+";                    box-shadow: 0 1px 15px rgba(0, 0, 0, 0.23);                }                        #widgetClientToctoc.closed {                    width: 200px;                    height: 30px;                    border-top-left-radius: 5px;                    border-top-right-radius: 5px;                    z-index: 800000;                    border: none;                    position: fixed;                    bottom: "+(d.initObj.bottom||"10px")+";                    right: "+(d.initObj.right||"0px")+";                    box-shadow: 0 1px 15px rgba(0, 0, 0, 0.23);                }                        @media all and (max-width: 680px){                    #widgetClientToctoc.open, #widgetClientToctoc.loginScreen, #widgetClientToctoc.nps{                    margin:0px;                    width: 100%;                    height: 100%;                    bottom: 0px;                    right: 0px;                    }                }                #widgetClientToctoc.hidden {                    display: none !important;                }                ",t=c.createElement("style");t.id="widgetClientToctocCss",t.type="text/css",t.innerHTML=e,c.head.appendChild(t)},d.show=function(){return d.container&&(d.container.classList.remove(u),d.container.classList.add(h),r.postMessage("easichat:show","*")),d},d.requestChannelStatus=function(e){if(d.container){var t="easichat:getChannelStatus:"+(e=e||Math.random().toString(36).substr(2,9));return d.container.contentWindow.postMessage(t,"*"),"easichat:status:"+e}return!1},d.switchToChannel=function(e){if(i&&d.container){if(e.domain&&e.channelId){if(d.initObj=JSON.parse(JSON.stringify(e)),c.URL.indexOf("noWidget")<0){var t=d.initObj.domain;d.initObj.channelId||d.initObj.langKey||d.initObj.clientLName||d.initObj.clientFName||d.initObj.clientEmail?(t+="/?",t+=null!=d.initObj.channelId?"Channel_Id="+d.initObj.channelId+"&":"",t+=null!=d.initObj.langKey?"langKey="+d.initObj.langKey+"&":"",t+=null!=d.initObj.clientLName?"cLName="+d.initObj.clientLName+"&":"",t+=null!=d.initObj.clientFName?"cFName="+d.initObj.clientFName+"&":"",t+=null!=d.initObj.clientEmail?"email="+d.initObj.clientEmail+"&":"",t+=null!=d.initObj.scope?"scope="+d.initObj.scope+"&":"",null!=d.initObj.customParams&&(t+="customParams="+JSON.stringify(d.initObj.customParams)+"&"),"&"==t[t.length-1]&&(t=t.slice(0,t.length-1)),t+="&deviceWith="+r.innerWidth):t+="/?deviceWith="+r.innerWidth,d.container.src=encodeURI(t)}return d}console.error("easichat init object is invalid")}else console.error("easichat widget has to be initialized first")},r.widgetClient=d,r.easichat=d}(window,document);